
import BIDMat.AllReduce;

val gmods = icol(4,2);
val M = prod(gmods).v;

val sim = new AllReduce(M,10000,1000);
sim.doSim = false;
sim.gmods = irow(4,2);
sim.gridmachines = irow(0->M);
sim.doConfigReduce = true;
sim.trace = 2;

sim.runSim(100);

val net = sim.network;
val m0 = net.machines(0);

val l0 = m0.layers(0);
